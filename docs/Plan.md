# План разработки сервиса уведомлений для Docsvision

## Цели
- Создать модульную архитектуру сервиса уведомлений с разделением по слоям и проектам.
- Обеспечить расширяемость для добавления новых типов уведомлений, каналов доставки и источников данных.
- Гарантировать наличие документирующих материалов и модульных тестов для каждого компонента.

## Ключевые артефакты
- Solution уровня `NotificationService.sln` c проектами:
  - `NotificationService.Domain`
  - `NotificationService.Application`
  - `NotificationService.Infrastructure`
  - `NotificationService.Api`
  - `NotificationService.Domain.Tests`
  - `NotificationService.Application.Tests`
  - `NotificationService.Infrastructure.Tests`
  - `NotificationService.Api.Tests`
- Документация по архитектуре и компонентам в каталоге `docs`.
- Шаблоны уведомлений и пример конфигурации SMTP.

## Чек-лист задач
- [x] Подготовить основной план проекта и описание задач
- [x] Настроить структуру solution и проектов
- [x] Реализовать доменный слой (модели, интерфейсы)
- [x] Реализовать слой приложений (DTO, use cases, сервисы)
- [x] Реализовать инфраструктурный слой (EF Core, email, шаблоны)
- [x] Реализовать REST API слой (контроллер уведомлений)
- [ ] Написать модульные тесты для всех слоёв
- [ ] Документировать API (Swagger аннотации, примеры)
- [ ] Добавить миграции EF Core и начальные данные

## Архитектурные принципы
1. **SOLID** — строгий контроль зависимостей и обязанностей компонентов.
2. **DRY** — повторяющаяся логика выносится в общие сервисы и базовые классы.
3. **KISS** — лаконичные и понятные решения, минимум сложных конструкций.
4. **Модульность** — каждый слой в отдельном проекте, взаимозависимости только через абстракции.

## Основные этапы
1. **Планирование и подготовка**
   - Создать файлы задач с чек-листами
   - Согласовать структуру solution и naming convention
2. **Архитектура и домен**
   - Определить модели уведомлений, пользователей, шаблонов
   - Описать интерфейсы для сервисов, провайдеров, репозиториев
3. **Слой приложений**
   - DTO, use cases, валидаторы
   - Сервис orchestration уведомлений
4. **Инфраструктура**
   - EF Core контекст и миграции
   - Реализация email-отправки через `System.Net.Mail`
   - Хранение шаблонов и менеджер шаблонов
5. **API**
   - REST контроллеры и запросы
   - Интеграция со слоями
   - Swagger/документация
6. **Тестирование и документация**
   - Написать unit-тесты для всех слоёв
   - Описать примеры использования
   - Подготовить глобальную документацию

## Риски и меры
- **Риск**: усложнение зависимостей между слоями → **Мера**: строгие правила ссылок и зависимостей.
- **Риск**: отсутствия покрытия тестами → **Мера**: внедрение unit-тестов на каждом этапе.
- **Риск**: сложности с настройкой SMTP → **Мера**: предусмотреть конфигурацию и fallback-стратегию.

## Следующие шаги
1. Добавить и прогнать модульные тесты для Application и Domain (валидатор, маппер, сервисы).
2. Настроить EF Core миграции (создание БД SQLite, начальные шаблоны и тестовые пользователи).
3. Расширить документацию Swagger: описания моделей/ответов и примеры.
4. Подготовить README с инструкцией по запуску и примером запроса/ответа.